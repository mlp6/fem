
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Thermal Modeling (June 2004) &#8212; FEM v6.9.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="thermal-modeling-june-2004">
<h1>Thermal Modeling (June 2004)<a class="headerlink" href="#thermal-modeling-june-2004" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The thermal Finite Element Method (FEM) models should be used to
evaluate the soft tissue heating that occurs in soft tissue due to
absorption of ultrasonic energy during ARFI imaging. There are two
publications regarding thermal response of tissues during ARFI imaging
that should be read before doing thermal modeling and measurements&nbsp;.</p>
<p>The models allow the user to input transducer specific parameters, such
as focal depth, F/#, element dimensions, etc. Depending on the focal
depth that is specified, a pre-made mesh is selected, and Field II&nbsp; is
run to solve for the intensity fields generated by the transducer. These
intensity fields are scaled by emperically-determined <span class="math notranslate">\(I_{spta}\)</span>
values, and then LS-DYNA is used to solve for the heating and cooling
behavior in tissue, using user-specified material properties. The
results are compared with thermocouple measurements in porcine muslce,
and then thermal-convolution scripts are run in MATLAB to solve for the
heating associated with different beam spacings, fields-of-view, and
focal depths.</p>
</div>
<div class="section" id="front-end">
<h2>Front End<a class="headerlink" href="#front-end" title="Permalink to this headline">¶</a></h2>
<p>[This still needs to be written (PERL).]</p>
</div>
<div class="section" id="fem-meshes">
<h2>FEM Meshes<a class="headerlink" href="#fem-meshes" title="Permalink to this headline">¶</a></h2>
<p>The meshes used for the models need to be as small as possible, in terms
of node counts and number of elements, to reduce computation overhead
and disk usage. When modeling, low-freqeuncy transducer at deep docal
depths, larger meshes are necessary. This document will be written with
the VF10-5, and it’s assocaited mesh, in mind.</p>
<p>Generic meshes are saved as XDCRmaxfocdepth.dyn (e.g.,
VF105foc25mm.dyn). These meshes are LS-DYNA input deck templates that
contain input for the FEM runs, including the node/element information.
Field II will be used to solve for the intesities at these nodal
locations (calc_hp). This information is read into MATLAB using
read_dyna_nodes.m, which saves a variable
<strong>measurementPointsandNodes</strong> that contains the node IDs, along with the
x, y, and z coordinates respectively.</p>
<p>New meshes will need to be generated if you have a transducer that will
need to go deeper than one of the current meshes allows or if the
transducer has a doemetry that doesn’t conform to a pre-existing mesh.
HyperMesh is a Windows-based program that can be used to generate meshes
that can be exported for use in LS-DYNA. Documentation and tutorials for
how to use HyperMesh, along with tutorial exercises can be found in
/data/jlb/src/altair/6.0/docs/ . Doug Dumont has also written a nice
tutorial on how to use HyperMesh (HyperMesh.pdf).</p>
</div>
<div class="section" id="field-ii">
<h2>Field II<a class="headerlink" href="#field-ii" title="Permalink to this headline">¶</a></h2>
<p>Field II is called from within the front end PERL script to solve to the
intensity values at each nodal location for each focal configuration and
material attenuation. [The old scripts used to do this are field2dyna.m
and fieldprms3d_arfi.m .] The results are saved into MATLAB files
called dyna_isptaout_att??.mat, which include the
measurementPointsandNodes variable, along with an isptaout variable that
has node intensity values for select nodes in the mesh where ultrasonic
energy is absorbed.</p>
</div>
<div class="section" id="intensity-measurements">
<h2>Intensity Measurements<a class="headerlink" href="#intensity-measurements" title="Permalink to this headline">¶</a></h2>
<p>The intensity fields that are simulated by Field II need to be scaled up
to values that will be used <em>in vivo</em>. This is accomplished by
performing a linear extrapolation of the of small-signal derated
intensity fields, as outlined in the 2002 NCRP report&nbsp;. First, intensity
measurements are made using a hydrophone in a water tank at low power
values to avoid saturation of the water. [CITE DOCUMENTATION ON MAKING
HYDROPHONE MEASUREMENTS]</p>
</div>
<div class="section" id="thermocouple-measurements">
<h2>Thermocouple Measurements<a class="headerlink" href="#thermocouple-measurements" title="Permalink to this headline">¶</a></h2>
<p>See Kristin Frinkley’s document on making thermocouple measurements
(tcprotocol.pdf).</p>
</div>
<div class="section" id="ls-dyna">
<h2>LS-DYNA<a class="headerlink" href="#ls-dyna" title="Permalink to this headline">¶</a></h2>
<p>LS-DYNA is a non-linear, three-dimensional, finite element analysis
program that is used for structural and thermal modeling in the lab.
Documentation for running models in LS-DYNA can be found in
/data/jlb/src/lstc/docs/. Details on the types of elements used in the
models are included in the first thermal publications&nbsp;.</p>
<p>Once the intesity values from Field II are scale appropraitely using the
hydrophone and thermocouple measurements, these values must be converted
to heat sources to modeling the heating behavior or the tissue, or to
initial temperatures to model the cooling of the tissue. We will start
with the later case.</p>
<p>As outlined in the first thermal publication&nbsp;, when heat is applied over
a short time period relative to the thermal conductivity of the materal,
the temperature increase can be solved using Equation&nbsp;[inittemp]:</p>
<div class="math notranslate">
\[\Delta{T} = {q_v \over c_v} t = {2 \alpha I \over c_v} t.
\label{inittemp}\]</div>
<p><span class="math notranslate">\(I\)</span> in Equation&nbsp;[inittemp] is the scaled intensity value that was
determined in the earlier sections of this document. By inputing initial
temperatures, the FEA can be performed with cruder time steps for
cooling response. These initial temperatures are determined using the
MATLAB script make_asc_therm.m, which saves the file inittemps.asc,
which has column data of the form: node ID, initial temp (deg C). This
file is then read in as an initial condition into the LS-DYNA input deck
under the card <strong>INITIAL_TEMPERATURE_NODE</strong>.</p>
<p>Heat sources will need to be generated when the high-intesity ARFI
pushing pulses are applied over a greater time duration relative to the
thermal conductivity. If you are in doubt, generate the heat sources and
run the simulation. [NEED TO ADD ALL OF THIS]</p>
</div>
<div class="section" id="matlab-output">
<h2>MATLAB Output<a class="headerlink" href="#matlab-output" title="Permalink to this headline">¶</a></h2>
<p>LS-DYNA saves its results in d3plot files. To perform post-processing on
these results in MATLAB, these results are converted to MATLAB format
using the function d3plotConvert.m . This function reads in the header
of the binary d3plot file, and creates variables of the relevant data,
which in this case is nodal temperature data through time. This data is
saved to dyna_convolve_FR.mat and dyna_convolve_FR_elev.mat, which
contain the temperature data on the two symmetry faces (axial-lateral,
and axial-elevation respectively) through time. All other data in the
d3plot files is <strong>not</strong> saved to the MATLAB result files - if this data
is needed, it can be viewed using <strong>ls-prepost</strong> or saved separated in
MATLAB.</p>
</div>
<div class="section" id="thermal-convolution">
<h2>Thermal Convolution<a class="headerlink" href="#thermal-convolution" title="Permalink to this headline">¶</a></h2>
<p>The FEM analyzes the heating and cooling associated with a single ARFI
interrogation. To simulate the heating and cooling assocaited with
multiple lines per frame, and multiple frames of ARFI imaging,
convulation of the thermal results is performed in MATLAB using
convolveFR.m [THIS MIGHT CHANGE - NEED TO ADD LOTS OF COMMENTS TO CODE
ON HOW THIS WORKS - THE INVLUDE THAT CODE (VERBATIM) HERE]</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Thermal Modeling (June 2004)</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#front-end">Front End</a></li>
<li><a class="reference internal" href="#fem-meshes">FEM Meshes</a></li>
<li><a class="reference internal" href="#field-ii">Field II</a></li>
<li><a class="reference internal" href="#intensity-measurements">Intensity Measurements</a></li>
<li><a class="reference internal" href="#thermocouple-measurements">Thermocouple Measurements</a></li>
<li><a class="reference internal" href="#ls-dyna">LS-DYNA</a></li>
<li><a class="reference internal" href="#matlab-output">MATLAB Output</a></li>
<li><a class="reference internal" href="#thermal-convolution">Thermal Convolution</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/thermal.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Mark Palmeri.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/thermal.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>