
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Thermal Modeling (June 2004) &#8212; FEM v6.9.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Testing" href="testing.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="thermal-modeling-june-2004">
<h1>Thermal Modeling (June 2004)<a class="headerlink" href="#thermal-modeling-june-2004" title="Permalink to this heading">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<p>The thermal Finite Element Method (FEM) models should be used to
evaluate the soft tissue heating that occurs in soft tissue due to
absorption of ultrasonic energy during ARFI imaging. There are two
publications regarding thermal response of tissues during ARFI imaging
that should be read before doing thermal modeling and measurements .</p>
<p>The models allow the user to input transducer specific parameters, such
as focal depth, F/#, element dimensions, etc. Depending on the focal
depth that is specified, a pre-made mesh is selected, and Field II  is
run to solve for the intensity fields generated by the transducer. These
intensity fields are scaled by emperically-determined <span class="math notranslate nohighlight">\(I_{spta}\)</span>
values, and then LS-DYNA is used to solve for the heating and cooling
behavior in tissue, using user-specified material properties. The
results are compared with thermocouple measurements in porcine muslce,
and then thermal-convolution scripts are run in MATLAB to solve for the
heating associated with different beam spacings, fields-of-view, and
focal depths.</p>
</section>
<section id="front-end">
<h2>Front End<a class="headerlink" href="#front-end" title="Permalink to this heading">¶</a></h2>
<p>[This still needs to be written (PERL).]</p>
</section>
<section id="fem-meshes">
<h2>FEM Meshes<a class="headerlink" href="#fem-meshes" title="Permalink to this heading">¶</a></h2>
<p>The meshes used for the models need to be as small as possible, in terms
of node counts and number of elements, to reduce computation overhead
and disk usage. When modeling, low-freqeuncy transducer at deep docal
depths, larger meshes are necessary. This document will be written with
the VF10-5, and it’s assocaited mesh, in mind.</p>
<p>Generic meshes are saved as XDCRmaxfocdepth.dyn (e.g.,
VF105foc25mm.dyn). These meshes are LS-DYNA input deck templates that
contain input for the FEM runs, including the node/element information.
Field II will be used to solve for the intesities at these nodal
locations (calc_hp). This information is read into MATLAB using
read_dyna_nodes.m, which saves a variable
<strong>measurementPointsandNodes</strong> that contains the node IDs, along with the
x, y, and z coordinates respectively.</p>
<p>New meshes will need to be generated if you have a transducer that will
need to go deeper than one of the current meshes allows or if the
transducer has a doemetry that doesn’t conform to a pre-existing mesh.
HyperMesh is a Windows-based program that can be used to generate meshes
that can be exported for use in LS-DYNA. Documentation and tutorials for
how to use HyperMesh, along with tutorial exercises can be found in
/data/jlb/src/altair/6.0/docs/ . Doug Dumont has also written a nice
tutorial on how to use HyperMesh (HyperMesh.pdf).</p>
</section>
<section id="field-ii">
<h2>Field II<a class="headerlink" href="#field-ii" title="Permalink to this heading">¶</a></h2>
<p>Field II is called from within the front end PERL script to solve to the
intensity values at each nodal location for each focal configuration and
material attenuation. [The old scripts used to do this are field2dyna.m
and fieldprms3d_arfi.m .] The results are saved into MATLAB files
called dyna_isptaout_att??.mat, which include the
measurementPointsandNodes variable, along with an isptaout variable that
has node intensity values for select nodes in the mesh where ultrasonic
energy is absorbed.</p>
</section>
<section id="intensity-measurements">
<h2>Intensity Measurements<a class="headerlink" href="#intensity-measurements" title="Permalink to this heading">¶</a></h2>
<p>The intensity fields that are simulated by Field II need to be scaled up
to values that will be used <em>in vivo</em>. This is accomplished by
performing a linear extrapolation of the of small-signal derated
intensity fields, as outlined in the 2002 NCRP report . First, intensity
measurements are made using a hydrophone in a water tank at low power
values to avoid saturation of the water. [CITE DOCUMENTATION ON MAKING
HYDROPHONE MEASUREMENTS]</p>
</section>
<section id="thermocouple-measurements">
<h2>Thermocouple Measurements<a class="headerlink" href="#thermocouple-measurements" title="Permalink to this heading">¶</a></h2>
<p>See Kristin Frinkley’s document on making thermocouple measurements
(tcprotocol.pdf).</p>
</section>
<section id="ls-dyna">
<h2>LS-DYNA<a class="headerlink" href="#ls-dyna" title="Permalink to this heading">¶</a></h2>
<p>LS-DYNA is a non-linear, three-dimensional, finite element analysis
program that is used for structural and thermal modeling in the lab.
Documentation for running models in LS-DYNA can be found in
/data/jlb/src/lstc/docs/. Details on the types of elements used in the
models are included in the first thermal publications .</p>
<p>Once the intesity values from Field II are scale appropraitely using the
hydrophone and thermocouple measurements, these values must be converted
to heat sources to modeling the heating behavior or the tissue, or to
initial temperatures to model the cooling of the tissue. We will start
with the later case.</p>
<p>As outlined in the first thermal publication , when heat is applied over
a short time period relative to the thermal conductivity of the materal,
the temperature increase can be solved using Equation [inittemp]:</p>
<div class="math notranslate nohighlight">
\[\Delta{T} = {q_v \over c_v} t = {2 \alpha I \over c_v} t.
\label{inittemp}\]</div>
<p><span class="math notranslate nohighlight">\(I\)</span> in Equation [inittemp] is the scaled intensity value that was
determined in the earlier sections of this document. By inputing initial
temperatures, the FEA can be performed with cruder time steps for
cooling response. These initial temperatures are determined using the
MATLAB script make_asc_therm.m, which saves the file inittemps.asc,
which has column data of the form: node ID, initial temp (deg C). This
file is then read in as an initial condition into the LS-DYNA input deck
under the card <strong>INITIAL_TEMPERATURE_NODE</strong>.</p>
<p>Heat sources will need to be generated when the high-intesity ARFI
pushing pulses are applied over a greater time duration relative to the
thermal conductivity. If you are in doubt, generate the heat sources and
run the simulation. [NEED TO ADD ALL OF THIS]</p>
</section>
<section id="matlab-output">
<h2>MATLAB Output<a class="headerlink" href="#matlab-output" title="Permalink to this heading">¶</a></h2>
<p>LS-DYNA saves its results in d3plot files. To perform post-processing on
these results in MATLAB, these results are converted to MATLAB format
using the function d3plotConvert.m . This function reads in the header
of the binary d3plot file, and creates variables of the relevant data,
which in this case is nodal temperature data through time. This data is
saved to dyna_convolve_FR.mat and dyna_convolve_FR_elev.mat, which
contain the temperature data on the two symmetry faces (axial-lateral,
and axial-elevation respectively) through time. All other data in the
d3plot files is <strong>not</strong> saved to the MATLAB result files - if this data
is needed, it can be viewed using <strong>ls-prepost</strong> or saved separated in
MATLAB.</p>
</section>
<section id="thermal-convolution">
<h2>Thermal Convolution<a class="headerlink" href="#thermal-convolution" title="Permalink to this heading">¶</a></h2>
<p>The FEM analyzes the heating and cooling associated with a single ARFI
interrogation. To simulate the heating and cooling assocaited with
multiple lines per frame, and multiple frames of ARFI imaging,
convulation of the thermal results is performed in MATLAB using
convolveFR.m [THIS MIGHT CHANGE - NEED TO ADD LOTS OF COMMENTS TO CODE
ON HOW THIS WORKS - THE INVLUDE THAT CODE (VERBATIM) HERE]</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">FEM</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_layout.html">Code Layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="coordinates_units.html">Coordinate &amp; Unit Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="create_dyna_mesh.html">Creating Rectilinear Meshes for LS-DYNA</a></li>
<li class="toctree-l1"><a class="reference internal" href="fem.mesh.html">fem.mesh package</a></li>
<li class="toctree-l1"><a class="reference internal" href="optistruct.html">OptiStruct Mesh Conversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="simulate_ARFI.html">Simulating Acoustic Radiation Force Excitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="fem.post.html">fem.post package</a></li>
<li class="toctree-l1"><a class="reference internal" href="hypermesh.html">Hypermesh Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="hypermesh.html#hypermesh-alternatives">HyperMesh Alternatives</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Thermal Modeling (June 2004)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#front-end">Front End</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fem-meshes">FEM Meshes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#field-ii">Field II</a></li>
<li class="toctree-l2"><a class="reference internal" href="#intensity-measurements">Intensity Measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#thermocouple-measurements">Thermocouple Measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ls-dyna">LS-DYNA</a></li>
<li class="toctree-l2"><a class="reference internal" href="#matlab-output">MATLAB Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="#thermal-convolution">Thermal Convolution</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="testing.html" title="previous chapter">Testing</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Mark Palmeri.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/thermal.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>